import{a as l}from"./chunk-VPXWIT43.js";import{W as s,_ as o,h as a,j as i}from"./chunk-DLCYNODX.js";var b=class t{constructor(e){this.apiService=e;this.loadTableFromStorage()}currentTable=null;currentTableSubject=new i(null);currentTable$=this.currentTableSubject.asObservable();loadTableFromStorage(){let e=sessionStorage.getItem("currentTable");e&&(this.currentTable=JSON.parse(e),this.currentTableSubject.next(this.currentTable))}saveTableToStorage(e){sessionStorage.setItem("currentTable",JSON.stringify(e))}validateQrToken(e){return this.apiService.get(`/api/tables/${e}`)}setCurrentTable(e){this.currentTable=e,this.saveTableToStorage(e),this.currentTableSubject.next(e)}getCurrentTable(){return this.currentTable}hasTable(){return this.currentTable!==null}clearTable(){this.currentTable=null,sessionStorage.removeItem("currentTable"),this.currentTableSubject.next(null)}setPendingToken(e){sessionStorage.setItem("pendingQrToken",e)}getPendingToken(){return sessionStorage.getItem("pendingQrToken")}clearPendingToken(){sessionStorage.removeItem("pendingQrToken")}setOrderPreferences(e,r){sessionStorage.setItem("orderPreferences",JSON.stringify({nb_people:e,vibe_id:r}))}getOrderPreferences(){let e=sessionStorage.getItem("orderPreferences");return e?JSON.parse(e):{nb_people:1,vibe_id:null}}clearOrderPreferences(){sessionStorage.removeItem("orderPreferences")}validateAndSavePendingToken(){let e=this.getPendingToken();return e?new a(r=>{this.validateQrToken(e).subscribe({next:n=>{n.success&&n.data&&this.setCurrentTable(n.data),this.clearPendingToken(),r.next(!0),r.complete()},error:()=>{this.clearPendingToken(),r.next(!1),r.complete()}})}):new a(r=>{r.next(!1),r.complete()})}static \u0275fac=function(r){return new(r||t)(o(l))};static \u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"})};export{b as a};
