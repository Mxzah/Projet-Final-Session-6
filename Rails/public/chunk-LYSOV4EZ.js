import{a as re}from"./chunk-V2PGNMVZ.js";import{a as ne}from"./chunk-AO5YKEZX.js";import{a as ie}from"./chunk-ROZZO4PU.js";import{c as j}from"./chunk-3BQBFXV3.js";import{a as V,c as G,e as H}from"./chunk-N5RVWXTN.js";import{a as W,b as X}from"./chunk-RE3ZHY4F.js";import{a as Z,c as ee,g as te}from"./chunk-NPE3J6VK.js";import{D as B,E as $,H as U,I as K,w as L,z as N}from"./chunk-FLJ6PJLF.js";import{ga as Y,ka as q,la as J,ma as Q}from"./chunk-D5QILQE7.js";import{g as E,i as z}from"./chunk-F3C3U3PJ.js";import{a as F,b as A}from"./chunk-67GKTUIW.js";import"./chunk-ZIWWK3EM.js";import{Ab as C,Bb as w,Cb as h,D as M,Db as c,Eb as r,F as O,Fb as a,Gb as b,Lb as T,Pb as f,Rb as p,Sa as S,Ua as n,bb as v,da as P,dc as m,ea as y,ec as s,fc as R,hb as I,i as x,oc as k,pc as D,qa as g,xb as u,yb as _}from"./chunk-AI52TPR3.js";var oe=(o,e)=>e.value,me=(o,e)=>e.id;function se(o,e){if(o&1&&(r(0,"mat-option",9),m(1),a()),o&2){let t=e.$implicit,i=p();c("value",t.value),n(),s(i.ts.t(t.labelKey))}}function le(o,e){if(o&1&&(r(0,"mat-option",9),m(1),a()),o&2){let t=e.$implicit;c("value",t.toString()),n(),R("",t," \u2605")}}function de(o,e){o&1&&(r(0,"div",14),b(1,"mat-spinner",17),a())}function ce(o,e){if(o&1&&(r(0,"div",15)(1,"mat-icon"),m(2,"rate_review"),a(),r(3,"p"),m(4),a()()),o&2){let t=p();n(4),s(t.ts.t("admin.reviews.noReviews"))}}function pe(o,e){if(o&1&&b(0,"img",29),o&2){let t=e.$implicit,i=p(4);c("src",i.getImageUrl(t),S)}}function ge(o,e){if(o&1&&(r(0,"div",26),w(1,pe,1,1,"img",29,C),a()),o&2){let t=p().$implicit;n(),h(t.image_urls)}}function fe(o,e){if(o&1){let t=T();r(0,"mat-card",18)(1,"mat-card-content")(2,"div",19)(3,"div",20)(4,"span",21),m(5),a(),r(6,"span",22),m(7),a()(),r(8,"button",23),f("click",function(){let d=P(t).$implicit,l=p(2);return y(l.confirmDelete(d))}),r(9,"mat-icon"),m(10,"delete"),a()()(),r(11,"div",24)(12,"mat-icon"),m(13),a(),r(14,"span"),m(15),a()(),r(16,"div",25),m(17),a(),u(18,ge,3,0,"div",26),r(19,"p",27),m(20),a(),r(21,"span",28),m(22),k(23,"date"),a()()()}if(o&2){let t=e.$implicit,i=p(2);n(5),s(t.user_name),n(2),s(t.reviewable_type==="User"?i.ts.t("admin.reviews.typeServer"):t.reviewable_type),n(6),s(t.reviewable_type==="User"?"person":"restaurant"),n(2),s(t.reviewable_name),n(2),s(i.renderStars(t.rating)),n(),_(t.image_urls&&t.image_urls.length>0?18:-1),n(2),s(t.comment),n(2),s(D(23,8,t.created_at,"medium"))}}function ve(o,e){if(o&1&&(r(0,"div",16),w(1,fe,24,11,"mat-card",18,me),a()),o&2){let t=p();n(),h(t.reviews())}}var ae=class o{constructor(e,t,i,d){this.reviewService=e;this.dialog=t;this.snackBar=i;this.ts=d}reviews=g([]);isLoading=g(!0);searchTerm=g("");filterType=g("all");filterRating=g("all");sortOrder=g("newest");searchSubject=new x;searchSubscription;reviewableTypes=[{value:"Item",labelKey:"admin.reviews.typeItem"},{value:"Combo",labelKey:"admin.reviews.typeCombo"},{value:"User",labelKey:"admin.reviews.typeServer"}];ratings=[1,2,3,4,5];ngOnInit(){this.searchSubscription=this.searchSubject.pipe(M(300),O()).subscribe(()=>this.loadData()),this.loadData()}ngOnDestroy(){this.searchSubscription?.unsubscribe()}loadData(){this.isLoading.set(!0);let e={};this.searchTerm()&&(e.search=this.searchTerm()),this.filterType()!=="all"&&(e.reviewable_type=this.filterType()),this.filterRating()!=="all"&&(e.rating=this.filterRating()),e.sort=this.sortOrder(),this.reviewService.getReviews(e).subscribe({next:t=>{this.reviews.set(t.data||[]),this.isLoading.set(!1)},error:()=>{this.isLoading.set(!1)}})}onSearchChange(e){let t=e.target.value;this.searchTerm.set(t),this.searchSubject.next(t)}onFilterTypeChange(e){this.filterType.set(e),this.loadData()}onFilterRatingChange(e){this.filterRating.set(e),this.loadData()}onSortChange(e){this.sortOrder.set(e),this.loadData()}confirmDelete(e){let t={title:this.ts.t("reviews.deleteReview"),message:this.ts.t("admin.reviews.deleteConfirm"),itemName:e.reviewable_name,confirmLabel:this.ts.t("admin.delete"),confirmClass:"btn-danger"};this.dialog.open(ie,{data:t,width:"440px"}).afterClosed().subscribe(d=>{d&&this.reviewService.deleteReview(e.id).subscribe({next:l=>{l.success&&(this.snackBar.open(this.ts.t("admin.reviews.reviewDeleted"),"",{duration:3e3}),this.loadData())}})})}getImageUrl(e){return`${F.apiUrl}${e}`}renderStars(e){return"\u2605".repeat(e)+"\u2606".repeat(5-e)}static \u0275fac=function(t){return new(t||o)(v(re),v(j),v(ne),v(A))};static \u0275cmp=I({type:o,selectors:[["app-admin-reviews"]],decls:41,vars:19,consts:[[1,"page-header"],[1,"subtitle"],[1,"filters-bar"],["appearance","outline",1,"filter-field","search-field"],["matPrefix",""],["matInput","",3,"input","placeholder","value"],["appearance","outline",1,"filter-field"],[3,"selectionChange","value"],["value","all"],[3,"value"],["value","newest"],["value","oldest"],["value","rating_high"],["value","rating_low"],[1,"spinner-wrapper"],[1,"empty-state"],[1,"reviews-grid"],["diameter","48"],[1,"review-card"],[1,"review-header"],[1,"review-meta"],[1,"reviewer-name"],[1,"review-type-badge"],["mat-icon-button","",1,"btn-delete",3,"click"],[1,"review-target"],[1,"review-stars"],[1,"review-images"],[1,"review-comment"],[1,"review-date"],[1,"review-thumb",3,"src"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"h1"),m(2),a(),r(3,"p",1),m(4),a()(),r(5,"div",2)(6,"mat-form-field",3)(7,"mat-icon",4),m(8,"search"),a(),r(9,"input",5),f("input",function(l){return i.onSearchChange(l)}),a()(),r(10,"mat-form-field",6)(11,"mat-label"),m(12),a(),r(13,"mat-select",7),f("selectionChange",function(l){return i.onFilterTypeChange(l.value)}),r(14,"mat-option",8),m(15),a(),w(16,se,2,2,"mat-option",9,oe),a()(),r(18,"mat-form-field",6)(19,"mat-label"),m(20),a(),r(21,"mat-select",7),f("selectionChange",function(l){return i.onFilterRatingChange(l.value)}),r(22,"mat-option",8),m(23),a(),w(24,le,2,2,"mat-option",9,C),a()(),r(26,"mat-form-field",6)(27,"mat-label"),m(28),a(),r(29,"mat-select",7),f("selectionChange",function(l){return i.onSortChange(l.value)}),r(30,"mat-option",10),m(31),a(),r(32,"mat-option",11),m(33),a(),r(34,"mat-option",12),m(35),a(),r(36,"mat-option",13),m(37),a()()()(),u(38,de,2,0,"div",14),u(39,ce,5,1,"div",15),u(40,ve,3,0,"div",16)),t&2&&(n(2),s(i.ts.t("admin.reviews.title")),n(2),s(i.ts.t("admin.reviews.subtitle")),n(5),c("placeholder",i.ts.t("admin.reviews.search"))("value",i.searchTerm()),n(3),s(i.ts.t("admin.reviews.filterType")),n(),c("value",i.filterType()),n(2),s(i.ts.t("admin.reviews.all")),n(),h(i.reviewableTypes),n(4),s(i.ts.t("admin.reviews.filterRating")),n(),c("value",i.filterRating()),n(2),s(i.ts.t("admin.reviews.all")),n(),h(i.ratings),n(4),s(i.ts.t("admin.reviews.sort")),n(),c("value",i.sortOrder()),n(2),s(i.ts.t("admin.reviews.sortNewest")),n(2),s(i.ts.t("admin.reviews.sortOldest")),n(2),s(i.ts.t("admin.reviews.sortRatingHigh")),n(2),s(i.ts.t("admin.reviews.sortRatingLow")),n(),_(i.isLoading()?38:-1),n(),_(!i.isLoading()&&i.reviews().length===0?39:-1),n(),_(!i.isLoading()&&i.reviews().length>0?40:-1))},dependencies:[z,te,Z,ee,q,Y,Q,J,$,B,L,N,K,U,H,G,V,X,W,E],styles:['@import"https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Space+Grotesk:wght@400;500;600&display=swap";[_nghost-%COMP%]{--ink: #1b1a17;--clay: #f3ede4;--sand: #fbf8f2;--copper: #c86d3f;--rust: #8a3f24;--sage: #7a8f6a;--shadow: 0 25px 60px rgba(27, 26, 23, .18);display:block;min-height:100vh;overflow-x:clip;overflow-y:visible;background:radial-gradient(circle at top left,#f7e6d8,#f9f5ef 45%,#efe7dc);color:var(--ink);font-family:Space Grotesk,Segoe UI,sans-serif}[_nghost-%COMP%]:before, [_nghost-%COMP%]:after{content:"";position:fixed;inset:auto auto 8% -10%;width:320px;height:320px;background:conic-gradient(from 120deg,#c86d3f26,#7a8f6a26);border-radius:50%;filter:blur(10px);z-index:0}[_nghost-%COMP%]:after{inset:-5% -10% auto auto;width:280px;height:280px;background:radial-gradient(circle,rgba(200,109,63,.2),transparent 70%)}.page[_ngcontent-%COMP%]{position:relative;z-index:1;display:grid;grid-template-columns:minmax(280px,560px);justify-content:center;align-items:start;padding:1rem clamp(1rem,3vw,3rem) 1.5rem}.site-header[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;justify-content:space-between;padding:1rem clamp(1rem,3vw,3rem);background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff}.brand[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;letter-spacing:.3rem;text-transform:uppercase;color:#fff}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem}.panel[_ngcontent-%COMP%]{background:var(--sand);border-radius:24px;padding:1.5rem 2rem;box-shadow:var(--shadow);border:1px solid rgba(27,26,23,.08);animation:_ngcontent-%COMP%_float-in .8s ease forwards}.panel__header[_ngcontent-%COMP%]{display:grid;gap:.25rem;margin-bottom:1rem}.eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.2rem;font-size:.75rem;color:var(--rust);margin:0}h1[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:clamp(2rem,3vw,2.6rem);margin:0}.subtitle[_ngcontent-%COMP%]{margin:0;color:#1b1a17b3}.form[_ngcontent-%COMP%]{display:grid;gap:.75rem}.field[_ngcontent-%COMP%]{display:grid;gap:.25rem}label[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border:1px solid rgba(27,26,23,.2);border-radius:12px;padding:.65rem .875rem;font-size:.95rem;background:#fff;transition:border-color .2s ease,box-shadow .2s ease}input[_ngcontent-%COMP%]:not([matInput]):focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--copper);box-shadow:0 0 0 3px #c86d3f33}.form__actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem;margin-top:.5rem}button[_ngcontent-%COMP%]{border-radius:999px;padding:.65rem 1.5rem;font-size:.9rem;font-weight:600;cursor:pointer;border:none}.primary[_ngcontent-%COMP%]{background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff;box-shadow:0 12px 25px #8a3f2459}.ghost[_ngcontent-%COMP%]{background:transparent;border:1px solid rgba(27,26,23,.2);color:var(--ink)}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]{border-color:#fff6;color:#fff}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]:hover{background:#ffffff26}@keyframes _ngcontent-%COMP%_float-in{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media(max-width:900px){.page[_ngcontent-%COMP%]{min-height:auto}}@media(max-width:600px){.panel[_ngcontent-%COMP%]{padding:2rem 1.5rem;border-radius:20px}.site-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.form__actions[_ngcontent-%COMP%]{flex-direction:column}button[_ngcontent-%COMP%]{width:100%}h1[_ngcontent-%COMP%]{font-size:1.75rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{padding:.75rem .875rem;font-size:.95rem}}@media(max-width:400px){[_nghost-%COMP%]{overflow-x:clip;overflow-y:visible}.page[_ngcontent-%COMP%]{padding:1.5rem 1rem 3rem;grid-template-columns:1fr}.panel[_ngcontent-%COMP%]{padding:1.5rem 1rem;border-radius:16px}.site-header[_ngcontent-%COMP%]{padding:1rem 1rem 0}h1[_ngcontent-%COMP%]{font-size:1.5rem}.subtitle[_ngcontent-%COMP%]{font-size:.9rem}label[_ngcontent-%COMP%]{font-size:.875rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border-radius:10px;padding:.7rem .75rem;font-size:.9rem}button[_ngcontent-%COMP%]{padding:.7rem 1.2rem;font-size:.9rem}}.page-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}h1[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:clamp(1.6rem,2.5vw,2.2rem);color:var(--ink);margin:0 0 .25rem}.subtitle[_ngcontent-%COMP%]{margin:0;color:#1b1a1799}.filters-bar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem;margin-bottom:1.5rem}.filter-field[_ngcontent-%COMP%]{min-width:140px;flex:1}.search-field[_ngcontent-%COMP%]{flex:2;min-width:200px}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:4rem 0}  .mat-mdc-progress-spinner circle{stroke:var(--copper)!important}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem;padding:5rem 0;color:#1b1a1766;font-size:1.1rem}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem}.reviews-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1rem}.review-card[_ngcontent-%COMP%]{background:#fbf8f2!important;border-radius:16px!important;border:1px solid rgba(27,26,23,.08)!important;box-shadow:0 2px 12px #1b1a170f!important}mat-card-content[_ngcontent-%COMP%]{padding:1rem 1.25rem!important}.review-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:.5rem}.review-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.reviewer-name[_ngcontent-%COMP%]{font-weight:600;font-size:.95rem;color:var(--ink)}.review-type-badge[_ngcontent-%COMP%]{font-size:.7rem;text-transform:uppercase;letter-spacing:.05rem;background:#c86d3f1a;color:var(--copper);padding:.15rem .5rem;border-radius:999px;font-weight:600}.btn-delete[_ngcontent-%COMP%]{color:#1b1a1759!important;width:32px!important;height:32px!important}.btn-delete[_ngcontent-%COMP%]:hover{color:var(--rust)!important}.btn-delete[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.1rem!important}.review-target[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem;color:#1b1a1799;font-size:.85rem;margin-bottom:.4rem}.review-target[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.review-stars[_ngcontent-%COMP%]{color:var(--copper);font-size:1.2rem;letter-spacing:.1rem;margin-bottom:.4rem}.review-images[_ngcontent-%COMP%]{display:flex;gap:.4rem;margin-bottom:.5rem}.review-thumb[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:8px;object-fit:cover;border:1px solid rgba(27,26,23,.1)}.review-comment[_ngcontent-%COMP%]{font-size:.88rem;color:var(--ink);margin:0 0 .5rem;line-height:1.5}.review-date[_ngcontent-%COMP%]{font-size:.75rem;color:#1b1a1766}@media(max-width:600px){.filters-bar[_ngcontent-%COMP%]{flex-direction:column}.reviews-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}']})};export{ae as AdminReviewsComponent};
