import{c as b}from"./chunk-67GKTUIW.js";import{V as i,Z as s,h as a,qa as o,tc as l}from"./chunk-AI52TPR3.js";var c=class t{constructor(e){this.apiService=e;this.loadTableFromStorage()}currentTableSignal=o(null);currentTable=this.currentTableSignal.asReadonly();hasTable=l(()=>this.currentTableSignal()!==null);loadTableFromStorage(){let e=sessionStorage.getItem("currentTable");e&&this.currentTableSignal.set(JSON.parse(e))}saveTableToStorage(e){sessionStorage.setItem("currentTable",JSON.stringify(e))}validateQrToken(e){return this.apiService.get(`/api/tables/${e}`)}setCurrentTable(e){this.currentTableSignal.set(e),this.saveTableToStorage(e)}getCurrentTable(){return this.currentTableSignal()}clearTable(){this.currentTableSignal.set(null),sessionStorage.removeItem("currentTable")}setPendingToken(e){sessionStorage.setItem("pendingQrToken",e)}getPendingToken(){return sessionStorage.getItem("pendingQrToken")}clearPendingToken(){sessionStorage.removeItem("pendingQrToken")}setOrderPreferences(e,r){sessionStorage.setItem("orderPreferences",JSON.stringify({nb_people:e,vibe_id:r}))}getOrderPreferences(){let e=sessionStorage.getItem("orderPreferences");return e?JSON.parse(e):{nb_people:1,vibe_id:null}}clearOrderPreferences(){sessionStorage.removeItem("orderPreferences")}validateAndSavePendingToken(){let e=this.getPendingToken();return e?new a(r=>{this.validateQrToken(e).subscribe({next:n=>{n.success&&n.data&&this.setCurrentTable(n.data),this.clearPendingToken(),r.next(!0),r.complete()},error:()=>{this.clearPendingToken(),r.next(!1),r.complete()}})}):new a(r=>{r.next(!1),r.complete()})}static \u0275fac=function(r){return new(r||t)(s(b))};static \u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"})};export{c as a};
