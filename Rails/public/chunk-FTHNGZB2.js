import{a as J}from"./chunk-7PWXPCXZ.js";import{a as Q}from"./chunk-RRROKC63.js";import{C as R,D as G,G as q,H as D,b as I,c as C,e as F,f as k,g as L,i as b,k as z,n as T,o as E,u as j,v as N,w as A}from"./chunk-HXVBPVRM.js";import{a as K}from"./chunk-4UJQ4NOE.js";import{c as H}from"./chunk-I7RYJ47G.js";import"./chunk-DCQBJ6LB.js";import{U as V,X as B,Z as U,_ as Y}from"./chunk-33DWQQLF.js";import{a as y}from"./chunk-RXENHBR6.js";import{c as w,d as S}from"./chunk-YFTZYEBV.js";import"./chunk-HALU6EK7.js";import{j as P}from"./chunk-TJODSPPL.js";import{Db as _,Eb as a,Fb as r,Gb as x,Pb as O,Rb as m,Ua as o,bb as d,dc as i,ec as c,fc as g,hb as M,qa as v,xb as f,yb as u}from"./chunk-QXPTUTPQ.js";function Z(n,l){if(n&1&&i(0),n&2){let e=m(2);g(" ",e.ts.t("login.emailRequired")," ")}}function $(n,l){if(n&1&&i(0),n&2){let e=m(2);g(" ",e.ts.t("login.emailInvalid")," ")}}function ee(n,l){if(n&1&&(a(0,"mat-error"),f(1,Z,1,1)(2,$,1,1),r()),n&2){let e,t=m();o(),u(!((e=t.loginForm.get("email"))==null||e.errors==null)&&e.errors.required?1:!((e=t.loginForm.get("email"))==null||e.errors==null)&&e.errors.email?2:-1)}}function te(n,l){if(n&1&&i(0),n&2){let e=m(2);g(" ",e.ts.t("login.passwordRequired")," ")}}function ne(n,l){if(n&1&&i(0),n&2){let e=m(2);g(" ",e.ts.t("login.passwordMinLength")," ")}}function oe(n,l){if(n&1&&i(0),n&2){let e=m(2);g(" ",e.ts.t("login.passwordMaxLength")," ")}}function ie(n,l){if(n&1&&(a(0,"mat-error"),f(1,te,1,1)(2,ne,1,1)(3,oe,1,1),r()),n&2){let e,t=m();o(),u(!((e=t.loginForm.get("password"))==null||e.errors==null)&&e.errors.required?1:!((e=t.loginForm.get("password"))==null||e.errors==null)&&e.errors.minlength?2:!((e=t.loginForm.get("password"))==null||e.errors==null)&&e.errors.maxlength?3:-1)}}function re(n,l){if(n&1&&(a(0,"div",13),i(1),r()),n&2){let e=m();o(),c(e.errorMessage())}}var W=class n{constructor(l,e,t,s,p,h){this.authService=l;this.cartService=e;this.orderService=t;this.tableService=s;this.router=p;this.ts=h}loginForm=new L({email:new b("",[C.required,C.email]),password:new b("",[C.required,C.minLength(6),C.maxLength(128)])});errorMessage=v("");isLoading=!1;onSubmit(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}this.errorMessage.set(""),this.isLoading=!0;let{email:l,password:e}=this.loginForm.value;this.authService.login(l,e).subscribe({next:t=>{if(this.isLoading=!1,this.cartService.clear(),this.authService.isCook()){this.router.navigate(["/cuisine"]);return}if(this.authService.isAdmin()){this.router.navigate(["/admin"]);return}this.orderService.getOrders().subscribe({next:s=>{let h=(s.data||[]).find(X=>!X.ended_at);h?(this.tableService.setCurrentTable({id:h.table_id,number:h.table_number,capacity:20,status:"active",qr_token:""}),this.router.navigate(["/menu"])):this.tableService.getPendingToken()?this.tableService.validateAndSavePendingToken().subscribe(()=>{this.router.navigate(["/form"])}):this.router.navigate(["/form"])},error:()=>{this.router.navigate(["/form"])}})},error:t=>{this.isLoading=!1,this.errorMessage.set(t?.errors?.join(", ")||this.ts.t("login.defaultError"))}})}static \u0275fac=function(e){return new(e||n)(d(y),d(J),d(Q),d(K),d(w),d(Y))};static \u0275cmp=M({type:n,selectors:[["app-login"]],decls:32,vars:16,consts:[[3,"showLogout"],[1,"page-login"],[1,"outer-container"],[1,"welcome-header"],[1,"welcome-title"],[1,"welcome-text"],[1,"inner-container"],[1,"panel__header"],[1,"subtitle"],["autocomplete","off",1,"form",3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field-full"],["matInput","","type","email","formControlName","email",3,"placeholder"],["matInput","","type","password","formControlName","password",3,"placeholder"],[1,"error-message"],[1,"form__actions","login-actions"],["mat-flat-button","","type","submit",1,"btn-primary",3,"disabled"],[1,"access-note"],["routerLink","/signup"]],template:function(e,t){if(e&1&&(x(0,"app-header",0),a(1,"main",1)(2,"div",2)(3,"div",3)(4,"h2",4),i(5),r(),a(6,"p",5),i(7),r()(),a(8,"section",6)(9,"header",7)(10,"h1"),i(11),r(),a(12,"p",8),i(13),r()(),a(14,"form",9),O("ngSubmit",function(){return t.onSubmit()}),a(15,"mat-form-field",10)(16,"mat-label"),i(17),r(),x(18,"input",11),f(19,ee,3,1,"mat-error"),r(),a(20,"mat-form-field",10)(21,"mat-label"),i(22),r(),x(23,"input",12),f(24,ie,4,1,"mat-error"),r(),f(25,re,2,1,"div",13),a(26,"div",14)(27,"button",15),i(28),r()()()(),a(29,"p",16)(30,"a",17),i(31),r()()()()),e&2){let s,p;_("showLogout",!1),o(5),c(t.ts.t("login.welcome")),o(2),c(t.ts.t("login.welcomeText")),o(4),c(t.ts.t("login.title")),o(2),c(t.ts.t("login.subtitle")),o(),_("formGroup",t.loginForm),o(3),c(t.ts.t("login.email")),o(),_("placeholder",t.ts.t("login.emailPlaceholder")),o(),u((s=t.loginForm.get("email"))!=null&&s.touched&&((s=t.loginForm.get("email"))!=null&&s.invalid)?19:-1),o(3),c(t.ts.t("login.password")),o(),_("placeholder",t.ts.t("login.passwordPlaceholder")),o(),u((p=t.loginForm.get("password"))!=null&&p.touched&&((p=t.loginForm.get("password"))!=null&&p.invalid)?24:-1),o(),u(t.errorMessage()?25:-1),o(2),_("disabled",t.isLoading||t.loginForm.invalid),o(),g(" ",t.isLoading?t.ts.t("login.loading"):t.ts.t("login.submit")," "),o(3),c(t.ts.t("login.createAccount"))}},dependencies:[j,z,I,F,k,E,T,P,S,H,G,R,N,A,D,q,B,V,U],styles:['@import"https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Space+Grotesk:wght@400;500;600&display=swap";[_nghost-%COMP%]{--ink: #1b1a17;--clay: #f3ede4;--sand: #fbf8f2;--copper: #c86d3f;--rust: #8a3f24;--sage: #7a8f6a;--shadow: 0 25px 60px rgba(27, 26, 23, .18);display:block;min-height:100vh;overflow-x:clip;overflow-y:visible;background:radial-gradient(circle at top left,#f7e6d8,#f9f5ef 45%,#efe7dc);color:var(--ink);font-family:Space Grotesk,Segoe UI,sans-serif}[_nghost-%COMP%]:before, [_nghost-%COMP%]:after{content:"";position:fixed;inset:auto auto 8% -10%;width:320px;height:320px;background:conic-gradient(from 120deg,#c86d3f26,#7a8f6a26);border-radius:50%;filter:blur(10px);z-index:0}[_nghost-%COMP%]:after{inset:-5% -10% auto auto;width:280px;height:280px;background:radial-gradient(circle,rgba(200,109,63,.2),transparent 70%)}.page[_ngcontent-%COMP%]{position:relative;z-index:1;display:grid;grid-template-columns:minmax(280px,560px);justify-content:center;align-items:start;padding:1rem clamp(1rem,3vw,3rem) 1.5rem}.site-header[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;justify-content:space-between;padding:1rem clamp(1rem,3vw,3rem);background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff}.brand[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;letter-spacing:.3rem;text-transform:uppercase;color:#fff}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem}.panel[_ngcontent-%COMP%]{background:var(--sand);border-radius:24px;padding:1.5rem 2rem;box-shadow:var(--shadow);border:1px solid rgba(27,26,23,.08);animation:_ngcontent-%COMP%_float-in .8s ease forwards}.panel__header[_ngcontent-%COMP%]{display:grid;gap:.25rem;margin-bottom:1rem}.eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.2rem;font-size:.75rem;color:var(--rust);margin:0}h1[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:clamp(2rem,3vw,2.6rem);margin:0}.subtitle[_ngcontent-%COMP%]{margin:0;color:#1b1a17b3}.form[_ngcontent-%COMP%]{display:grid;gap:.75rem}.field[_ngcontent-%COMP%]{display:grid;gap:.25rem}label[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border:1px solid rgba(27,26,23,.2);border-radius:12px;padding:.65rem .875rem;font-size:.95rem;background:#fff;transition:border-color .2s ease,box-shadow .2s ease}input[_ngcontent-%COMP%]:not([matInput]):focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--copper);box-shadow:0 0 0 3px #c86d3f33}.form__actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem;margin-top:.5rem}button[_ngcontent-%COMP%]{border-radius:999px;padding:.65rem 1.5rem;font-size:.9rem;font-weight:600;cursor:pointer;border:none}.primary[_ngcontent-%COMP%]{background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff;box-shadow:0 12px 25px #8a3f2459}.ghost[_ngcontent-%COMP%]{background:transparent;border:1px solid rgba(27,26,23,.2);color:var(--ink)}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]{border-color:#fff6;color:#fff}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]:hover{background:#ffffff26}@keyframes _ngcontent-%COMP%_float-in{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media(max-width:900px){.page[_ngcontent-%COMP%]{min-height:auto}}@media(max-width:600px){.panel[_ngcontent-%COMP%]{padding:2rem 1.5rem;border-radius:20px}.site-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.form__actions[_ngcontent-%COMP%]{flex-direction:column}button[_ngcontent-%COMP%]{width:100%}h1[_ngcontent-%COMP%]{font-size:1.75rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{padding:.75rem .875rem;font-size:.95rem}}@media(max-width:400px){[_nghost-%COMP%]{overflow-x:clip;overflow-y:visible}.page[_ngcontent-%COMP%]{padding:1.5rem 1rem 3rem;grid-template-columns:1fr}.panel[_ngcontent-%COMP%]{padding:1.5rem 1rem;border-radius:16px}.site-header[_ngcontent-%COMP%]{padding:1rem 1rem 0}h1[_ngcontent-%COMP%]{font-size:1.5rem}.subtitle[_ngcontent-%COMP%]{font-size:.9rem}label[_ngcontent-%COMP%]{font-size:.875rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border-radius:10px;padding:.7rem .75rem;font-size:.9rem}button[_ngcontent-%COMP%]{padding:.7rem 1.2rem;font-size:.9rem}}.page-login[_ngcontent-%COMP%]{position:relative;z-index:1;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 60px);padding:1rem}.outer-container[_ngcontent-%COMP%]{background:#c86d3f26;border:1px solid rgba(200,109,63,.2);border-radius:28px;padding:2.5rem;max-width:540px;width:100%;box-shadow:0 10px 40px #1b1a1714}.welcome-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.welcome-title[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:1.5rem;margin:0 0 .5rem;color:var(--rust)}.welcome-text[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#1b1a17b3}.inner-container[_ngcontent-%COMP%]{background:var(--sand);border-radius:20px;padding:2.5rem;border:1px solid rgba(27,26,23,.1)}.access-note[_ngcontent-%COMP%]{text-align:center;margin:1.5rem 0 0;font-size:.85rem}.access-note[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--rust);text-decoration:none;font-weight:500}.access-note[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.form-field-full[_ngcontent-%COMP%]{width:100%;margin-bottom:.25rem}  .inner-container .mat-mdc-form-field.mat-focused .mdc-notched-outline__leading,   .inner-container .mat-mdc-form-field.mat-focused .mdc-notched-outline__notch,   .inner-container .mat-mdc-form-field.mat-focused .mdc-notched-outline__trailing{border-color:#1b1a1740!important;border-width:1px!important}  .inner-container .mat-mdc-form-field.mat-focused .mat-mdc-floating-label{color:#1b1a1799!important}.login-actions[_ngcontent-%COMP%]{justify-content:center}.login-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.btn-primary[_ngcontent-%COMP%]{border-radius:10px!important;background:var(--copper)!important;color:#fff!important;font-family:Space Grotesk,Segoe UI,sans-serif!important;height:44px;font-size:.95rem!important}.btn-primary[_ngcontent-%COMP%]:hover{opacity:.9}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6!important;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{color:#dc3545;margin-bottom:.5rem;text-align:center}.form__footer[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem}.form__footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;text-decoration:none}.form__footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.field-error[_ngcontent-%COMP%]{color:#dc3545;font-size:.85rem;margin-top:.25rem}@media(max-width:500px){.page-login[_ngcontent-%COMP%]{padding:.5rem;min-height:calc(100vh - 40px)}.outer-container[_ngcontent-%COMP%]{padding:1rem;border-radius:16px;max-width:100%}.welcome-header[_ngcontent-%COMP%]{margin-bottom:1rem}.welcome-title[_ngcontent-%COMP%]{font-size:1.25rem;margin-bottom:.25rem}.welcome-text[_ngcontent-%COMP%]{font-size:.8rem}.inner-container[_ngcontent-%COMP%]{padding:1.25rem;border-radius:12px}.inner-container[_ngcontent-%COMP%]   .panel__header[_ngcontent-%COMP%]{margin-bottom:.75rem}.inner-container[_ngcontent-%COMP%]   .panel__header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.inner-container[_ngcontent-%COMP%]   .panel__header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:.85rem}.access-note[_ngcontent-%COMP%]{margin-top:1rem}}']})};export{W as LoginComponent};
