import{j as d,k as m}from"./chunk-SS6MEMTN.js";import{B as o,R as c,V as u,Z as l,m as h,n as i,q as a}from"./chunk-RLSS7KTN.js";var v={production:!0,apiUrl:""};var f=class n{constructor(s){this.http=s}apiUrl=v.apiUrl;post(s,e){return this.http.post(`${this.apiUrl}${s}`,e,{withCredentials:!0}).pipe(a(r=>{if(!r.success)throw r;return r}),o(r=>{if("success"in r&&r.success===!1)return i(()=>r);let t=r.error?.errors;return i(()=>({success:!1,data:null,errors:t||["Une erreur est survenue"]}))}))}get(s,e){let r=new d;if(e)for(let t of Object.keys(e))e[t]&&(r=r.set(t,e[t]));return this.http.get(`${this.apiUrl}${s}`,{withCredentials:!0,params:r}).pipe(a(t=>{if(!t.success)throw t;return t}),o(t=>{if("success"in t&&t.success===!1)return i(()=>t);let g=t.error?.errors;return i(()=>({success:!1,data:null,errors:g||["Une erreur est survenue"]}))}))}put(s,e){return this.http.put(`${this.apiUrl}${s}`,e,{withCredentials:!0}).pipe(a(r=>{if(!r.success)throw r;return r}),o(r=>{if("success"in r&&r.success===!1)return i(()=>r);let t=r.error?.errors;return i(()=>({success:!1,data:null,errors:t||["Une erreur est survenue"]}))}))}delete(s){return this.http.delete(`${this.apiUrl}${s}`,{withCredentials:!0}).pipe(a(e=>{if(!e.success)throw e;return e}),o(e=>{if("success"in e&&e.success===!1)return i(()=>e);let r=e.error?.errors;return i(()=>({success:!1,data:null,errors:r||["Une erreur est survenue"]}))}))}static \u0275fac=function(e){return new(e||n)(l(m))};static \u0275prov=u({token:n,factory:n.\u0275fac,providedIn:"root"})};var U=class n{constructor(s){this.apiService=s;this.loadUserFromStorage()}currentUser=null;isLoggedIn=!1;loadUserFromStorage(){let s=localStorage.getItem("currentUser");s&&(this.currentUser=JSON.parse(s),this.isLoggedIn=!0)}saveUserToStorage(s){localStorage.setItem("currentUser",JSON.stringify(s))}clearUserFromStorage(){localStorage.removeItem("currentUser")}login(s,e){let r={user:{email:s,password:e}};return this.apiService.post("/users/sign_in",r).pipe(c(t=>{t.success&&t.data&&(this.currentUser=t.data,this.saveUserToStorage(t.data),this.isLoggedIn=!0)}))}signup(s,e,r,t,g,b){let R={user:{email:s,password:e,password_confirmation:r,first_name:t,last_name:g,type:b}};return this.apiService.post("/users",R).pipe(c(p=>{p.success&&p.data&&(this.currentUser=p.data,this.saveUserToStorage(p.data),this.isLoggedIn=!0)}))}logout(){return this.apiService.delete("/users/sign_out").pipe(c(()=>{this.currentUser=null,this.clearUserFromStorage(),this.isLoggedIn=!1}),o(()=>(this.currentUser=null,this.clearUserFromStorage(),this.isLoggedIn=!1,h(null))))}isAuthenticated(){return this.isLoggedIn}isAdmin(){return this.currentUser?.type==="Administrator"}isWaiter(){return this.currentUser?.type==="Waiter"}isCook(){return this.currentUser?.type==="Cook"}isKitchenStaff(){return this.isAdmin()||this.isWaiter()||this.isCook()}getCurrentUser(){return this.currentUser}static \u0275fac=function(e){return new(e||n)(l(f))};static \u0275prov=u({token:n,factory:n.\u0275fac,providedIn:"root"})};export{f as a,U as b};
