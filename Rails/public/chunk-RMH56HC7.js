import{a as Z,c as ee,d as te,e as ne}from"./chunk-N5RVWXTN.js";import{a as le,b as me}from"./chunk-RE3ZHY4F.js";import{g as de}from"./chunk-NPE3J6VK.js";import{a as pe}from"./chunk-W4RF6HJM.js";import{A as J,D as K,E as Q,H as W,I as X,b as V,d as x,f as D,g as N,h as j,j as O,l as G,m as R,o as U,p as A,q,r as L,v as H,w as B,x as Y,y as $}from"./chunk-FLJ6PJLF.js";import{a as se}from"./chunk-2K6QFXNV.js";import{c as ce}from"./chunk-3TXLFX2C.js";import{ha as ie,ka as oe,la as re,ma as ae}from"./chunk-D5QILQE7.js";import{a as z}from"./chunk-CDTCJ4FF.js";import{c as F}from"./chunk-PJCREBP6.js";import{i as E}from"./chunk-F3C3U3PJ.js";import{b as k}from"./chunk-67GKTUIW.js";import"./chunk-ZIWWK3EM.js";import{Bb as y,Cb as w,Db as b,Eb as a,Fb as r,Gb as g,Lb as I,Pb as h,Rb as m,Ua as i,ac as M,bb as f,da as P,dc as l,ea as S,ec as s,fc as _,gc as C,hb as T,qa as v,xb as d,yb as c}from"./chunk-AI52TPR3.js";var ge=(t,o)=>o.id;function ue(t,o){if(t&1&&(a(0,"div",2)(1,"mat-icon",4),l(2,"qr_code_scanner"),r(),a(3,"h2",5),l(4),r(),a(5,"p",6),l(6),r()()),t&2){let e=m();i(4),s(e.ts.t("form.noTable")),i(2),s(e.ts.t("form.noTableText"))}}function be(t,o){if(t&1&&(a(0,"div",2)(1,"mat-icon",4),l(2,"block"),r(),a(3,"h2",5),l(4),r(),a(5,"p",6),l(6),r()()),t&2){let e=m();i(4),s(e.ts.t("form.tableUnavailable")),i(2),s(e.ts.t("form.tableUnavailableText"))}}function _e(t,o){if(t&1&&(a(0,"mat-error"),l(1),r()),t&2){let e=m(3);i(),s(e.ts.t("form.guestsRequired"))}}function xe(t,o){if(t&1&&(a(0,"mat-error"),l(1),r()),t&2){let e=m(3);i(),s(e.ts.t("form.guestsMin"))}}function Ce(t,o){if(t&1&&(a(0,"mat-error"),l(1),r()),t&2){let e=m(3);i(),C("",e.ts.t("form.guestsMax")," ",e.table.capacity,".")}}function ve(t,o){if(t&1&&d(0,_e,2,1,"mat-error")(1,xe,2,1,"mat-error")(2,Ce,2,2,"mat-error"),t&2){let e=m(2);c(e.guestCtrl.hasError("required")?0:e.guestCtrl.hasError("min")?1:e.guestCtrl.hasError("max")?2:-1)}}function he(t,o){if(t&1&&(g(0,"span",17),l(1)),t&2){let e=o;M("background",e.color),i(),_(" ",e.name," ")}}function Me(t,o){if(t&1&&(a(0,"mat-option",13),g(1,"mat-spinner",18),l(2),r()),t&2){let e=m(2);i(2),_(" ",e.ts.t("form.loading")," ")}}function Oe(t,o){if(t&1&&(a(0,"mat-option",19),g(1,"span",17),l(2),r()),t&2){let e=o.$implicit;b("value",e.id),i(),M("background",e.color),i(),_(" ",e.name," ")}}function Pe(t,o){if(t&1&&y(0,Oe,3,4,"mat-option",19,ge),t&2){let e=m(2);w(e.vibes)}}function Se(t,o){if(t&1&&(a(0,"mat-error"),l(1),r()),t&2){let e=m(2);i(),s(e.ts.t("form.vibeRequired"))}}function Te(t,o){if(t&1&&(a(0,"div",14)(1,"mat-icon"),l(2,"error_outline"),r(),a(3,"span"),l(4),r()()),t&2){let e=m(2);i(4),s(e.apiError())}}function ye(t,o){t&1&&(a(0,"mat-icon"),l(1,"restaurant_menu"),r())}function we(t,o){t&1&&g(0,"mat-spinner",16)}function Ie(t,o){if(t&1){let e=I();a(0,"div",3)(1,"div",7)(2,"h2",5),l(3),r(),a(4,"p",6),l(5),r()(),a(6,"form",8),h("ngSubmit",function(){P(e);let p=m();return S(p.goToMenu())}),a(7,"mat-form-field",9)(8,"mat-label"),l(9),r(),g(10,"input",10),a(11,"mat-icon",11),l(12,"people"),r(),a(13,"mat-hint"),l(14),r(),d(15,ve,3,1),r(),a(16,"mat-form-field",9)(17,"mat-label"),l(18),r(),a(19,"mat-select",12)(20,"mat-select-trigger"),d(21,he,2,3),r(),d(22,Me,3,1,"mat-option",13)(23,Pe,2,0),r(),d(24,Se,2,1,"mat-error"),r(),d(25,Te,5,1,"div",14),a(26,"button",15),d(27,ye,2,0,"mat-icon"),d(28,we,1,0,"mat-spinner",16),l(29),r()()()}if(t&2){let e,n=m();i(3),C("",n.ts.t("form.title")," #",n.table.number),i(2),s(n.ts.t("form.subtitle")),i(),b("formGroup",n.form),i(3),s(n.ts.t("form.guests")),i(),b("max",n.table.capacity),i(4),C("",n.ts.t("form.guestsHint")," ",n.table.capacity),i(),c(n.guestCtrl.touched?15:-1),i(3),s(n.ts.t("form.vibe")),i(3),c((e=n.getSelectedVibe())?21:-1,e),i(),c(n.vibesLoading?22:23),i(2),c(n.vibeCtrl.invalid&&n.vibeCtrl.touched?24:-1),i(),c(n.apiError()?25:-1),i(),b("disabled",n.form.invalid||n.vibesLoading||n.isSubmitting()),i(),c(n.isSubmitting()?-1:27),i(),c(n.isSubmitting()?28:-1),i(),_(" ",n.isSubmitting()?n.ts.t("form.submitting"):n.ts.t("form.submit")," ")}}var fe=class t{constructor(o,e,n,p,u){this.tableService=o;this.authService=e;this.orderService=n;this.ts=p;this.router=u}table=null;noTable=!1;tableUnavailable=!1;vibes=[];vibesLoading=!0;isSubmitting=v(!1);apiError=v(null);form;ngOnInit(){if(this.table=this.tableService.getCurrentTable(),!this.table){this.noTable=!0;return}if(!this.isTableAvailable(this.table)){this.tableUnavailable=!0;return}this.form=new j({guestCount:new O(null,[x.required,x.min(1),x.max(this.table.capacity)]),vibeId:new O(null,x.required)}),this.loadVibes()}loadVibes(){this.orderService.getVibes().subscribe({next:o=>{this.vibes=o.data||[],this.vibesLoading=!1},error:()=>{this.vibesLoading=!1}})}get guestCtrl(){return this.form.get("guestCount")}get vibeCtrl(){return this.form.get("vibeId")}getSelectedVibe(){return this.vibes.find(o=>o.id===this.vibeCtrl.value)??null}goToMenu(){if(this.form.invalid||this.isSubmitting())return;let{guestCount:o,vibeId:e}=this.form.value,n=this.table;this.isSubmitting.set(!0),this.apiError.set(null),this.orderService.createOrder({nb_people:o,note:"",table_id:n.id,vibe_id:e??null}).subscribe({next:()=>{this.router.navigate(["/menu"])},error:p=>{let u=p?.errors??[];this.apiError.set(u.length?u.join(" "):this.ts.t("form.createError")),this.isSubmitting.set(!1)}})}isTableAvailable(o){if(!o.availabilities||o.availabilities.length===0)return!1;let e=Date.now();return o.availabilities.some(n=>{let p=new Date(n.start_at).getTime(),u=n.end_at?new Date(n.end_at).getTime():1/0;return p<=e&&e<u})}logout(){this.authService.logout().subscribe({next:()=>{this.tableService.clearTable(),this.router.navigate(["/login"])},error:()=>{this.tableService.clearTable(),this.router.navigate(["/login"])}})}static \u0275fac=function(e){return new(e||t)(f(se),f(z),f(pe),f(k),f(F))};static \u0275cmp=T({type:t,selectors:[["app-table-form"]],decls:5,vars:3,consts:[[3,"logoutClick"],[1,"form-page"],[1,"form-card","no-table-card"],[1,"form-card"],[1,"no-table-icon"],[1,"form-title"],[1,"form-subtitle"],[1,"form-header"],[1,"form-body",3,"ngSubmit","formGroup"],["appearance","outline",1,"field-full"],["matInput","","type","number","formControlName","guestCount","min","1","step","1",3,"max"],["matSuffix",""],["formControlName","vibeId"],["disabled",""],[1,"api-error"],["mat-raised-button","","color","primary","type","submit",1,"submit-btn",3,"disabled"],["diameter","20",1,"btn-spinner"],[1,"vibe-dot"],["diameter","18",1,"inline-spinner"],[3,"value"]],template:function(e,n){e&1&&(a(0,"app-header",0),h("logoutClick",function(){return n.logout()}),r(),a(1,"main",1),d(2,ue,7,2,"div",2),d(3,be,7,2,"div",2),d(4,Ie,30,18,"div",3),r()),e&2&&(i(2),c(n.noTable?2:-1),i(),c(n.tableUnavailable?3:-1),i(),c(n.table&&!n.tableUnavailable?4:-1))},dependencies:[E,H,G,V,R,D,N,L,q,A,U,ce,Q,K,B,$,Y,J,X,W,ne,ee,te,Z,oe,ie,ae,re,de,me,le],styles:['@import"https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Space+Grotesk:wght@400;500;600&display=swap";[_nghost-%COMP%]{--ink: #1b1a17;--clay: #f3ede4;--sand: #fbf8f2;--copper: #c86d3f;--rust: #8a3f24;--sage: #7a8f6a;--shadow: 0 25px 60px rgba(27, 26, 23, .18);display:block;min-height:100vh;overflow-x:clip;overflow-y:visible;background:radial-gradient(circle at top left,#f7e6d8,#f9f5ef 45%,#efe7dc);color:var(--ink);font-family:Space Grotesk,Segoe UI,sans-serif}[_nghost-%COMP%]:before, [_nghost-%COMP%]:after{content:"";position:fixed;inset:auto auto 8% -10%;width:320px;height:320px;background:conic-gradient(from 120deg,#c86d3f26,#7a8f6a26);border-radius:50%;filter:blur(10px);z-index:0}[_nghost-%COMP%]:after{inset:-5% -10% auto auto;width:280px;height:280px;background:radial-gradient(circle,rgba(200,109,63,.2),transparent 70%)}.page[_ngcontent-%COMP%]{position:relative;z-index:1;display:grid;grid-template-columns:minmax(280px,560px);justify-content:center;align-items:start;padding:1rem clamp(1rem,3vw,3rem) 1.5rem}.site-header[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;justify-content:space-between;padding:1rem clamp(1rem,3vw,3rem);background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff}.brand[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;letter-spacing:.3rem;text-transform:uppercase;color:#fff}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem}.panel[_ngcontent-%COMP%]{background:var(--sand);border-radius:24px;padding:1.5rem 2rem;box-shadow:var(--shadow);border:1px solid rgba(27,26,23,.08);animation:_ngcontent-%COMP%_float-in .8s ease forwards}.panel__header[_ngcontent-%COMP%]{display:grid;gap:.25rem;margin-bottom:1rem}.eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.2rem;font-size:.75rem;color:var(--rust);margin:0}h1[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:clamp(2rem,3vw,2.6rem);margin:0}.subtitle[_ngcontent-%COMP%]{margin:0;color:#1b1a17b3}.form[_ngcontent-%COMP%]{display:grid;gap:.75rem}.field[_ngcontent-%COMP%]{display:grid;gap:.25rem}label[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border:1px solid rgba(27,26,23,.2);border-radius:12px;padding:.65rem .875rem;font-size:.95rem;background:#fff;transition:border-color .2s ease,box-shadow .2s ease}input[_ngcontent-%COMP%]:not([matInput]):focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--copper);box-shadow:0 0 0 3px #c86d3f33}.form__actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem;margin-top:.5rem}button[_ngcontent-%COMP%]{border-radius:999px;padding:.65rem 1.5rem;font-size:.9rem;font-weight:600;cursor:pointer;border:none}.primary[_ngcontent-%COMP%]{background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff;box-shadow:0 12px 25px #8a3f2459}.ghost[_ngcontent-%COMP%]{background:transparent;border:1px solid rgba(27,26,23,.2);color:var(--ink)}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]{border-color:#fff6;color:#fff}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]:hover{background:#ffffff26}@keyframes _ngcontent-%COMP%_float-in{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media(max-width:900px){.page[_ngcontent-%COMP%]{min-height:auto}}@media(max-width:600px){.panel[_ngcontent-%COMP%]{padding:2rem 1.5rem;border-radius:20px}.site-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.form__actions[_ngcontent-%COMP%]{flex-direction:column}button[_ngcontent-%COMP%]{width:100%}h1[_ngcontent-%COMP%]{font-size:1.75rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{padding:.75rem .875rem;font-size:.95rem}}@media(max-width:400px){[_nghost-%COMP%]{overflow-x:clip;overflow-y:visible}.page[_ngcontent-%COMP%]{padding:1.5rem 1rem 3rem;grid-template-columns:1fr}.panel[_ngcontent-%COMP%]{padding:1.5rem 1rem;border-radius:16px}.site-header[_ngcontent-%COMP%]{padding:1rem 1rem 0}h1[_ngcontent-%COMP%]{font-size:1.5rem}.subtitle[_ngcontent-%COMP%]{font-size:.9rem}label[_ngcontent-%COMP%]{font-size:.875rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border-radius:10px;padding:.7rem .75rem;font-size:.9rem}button[_ngcontent-%COMP%]{padding:.7rem 1.2rem;font-size:.9rem}}.form-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 60px);padding:1.5rem 1rem}.form-card[_ngcontent-%COMP%]{background:var(--sand);border:1px solid rgba(200,109,63,.2);border-radius:24px;padding:2.5rem;max-width:520px;width:100%;box-shadow:0 10px 40px #1b1a1714}.form-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.form-title[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:1.6rem;margin:0 0 .5rem;color:var(--rust)}.form-subtitle[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#1b1a17a6}.form-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.field-full[_ngcontent-%COMP%]{width:100%}.submit-btn[_ngcontent-%COMP%]{width:100%;margin-top:.75rem;height:48px;font-size:1rem!important;font-family:Space Grotesk,Segoe UI,sans-serif!important;border-radius:12px!important;background:linear-gradient(120deg,var(--copper),var(--rust))!important;color:#fff!important;display:flex;align-items:center;justify-content:center;gap:.5rem}.submit-btn[_ngcontent-%COMP%]:disabled{opacity:.55!important;cursor:not-allowed}.vibe-dot[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;border-radius:50%;margin-right:.5rem;flex-shrink:0;vertical-align:middle;border:1px solid rgba(27,26,23,.12)}.inline-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:.4rem}.no-table-card[_ngcontent-%COMP%]{text-align:center;padding:3rem 2.5rem;display:flex;flex-direction:column;align-items:center;gap:.75rem}.no-table-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;color:var(--copper);margin-bottom:.5rem}.api-error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:#8a3f2414;border:1px solid rgba(138,63,36,.25);color:var(--rust);border-radius:10px;padding:.65rem .9rem;font-size:.88rem}.api-error[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.1rem;width:1.1rem;height:1.1rem;flex-shrink:0}.btn-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:.5rem}  .form-body .mat-mdc-form-field.mat-focused .mdc-notched-outline__leading,   .form-body .mat-mdc-form-field.mat-focused .mdc-notched-outline__notch,   .form-body .mat-mdc-form-field.mat-focused .mdc-notched-outline__trailing{border-color:var(--copper)!important}  .form-body .mat-mdc-form-field.mat-focused .mat-mdc-floating-label{color:var(--copper)!important}  .form-body .mdc-text-field--focused .mdc-notched-outline__leading,   .form-body .mdc-text-field--focused .mdc-notched-outline__notch,   .form-body .mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--copper)!important}@media(max-width:560px){.form-page[_ngcontent-%COMP%]{padding:1.25rem .5rem .75rem;justify-content:flex-start}.form-card[_ngcontent-%COMP%]{padding:1.5rem 1.1rem;border-radius:16px}.form-title[_ngcontent-%COMP%]{font-size:1.3rem}.form-subtitle[_ngcontent-%COMP%]{font-size:.82rem}.form-header[_ngcontent-%COMP%]{margin-bottom:1.25rem}.submit-btn[_ngcontent-%COMP%]{height:44px;font-size:.92rem!important}}@media(max-width:380px){.form-page[_ngcontent-%COMP%]{padding:1rem .35rem .5rem}.form-card[_ngcontent-%COMP%]{padding:1.25rem .9rem;border-radius:14px}.form-title[_ngcontent-%COMP%]{font-size:1.15rem}}']})};export{fe as TableFormComponent};
