import{a as l}from"./chunk-HALU6EK7.js";import{B as c,R as s,V as u,Z as g,n}from"./chunk-QXPTUTPQ.js";var p=class a{constructor(r){this.apiService=r;this.loadUserFromStorage()}currentUser=null;isLoggedIn=!1;loadUserFromStorage(){let r=localStorage.getItem("currentUser");r&&(this.currentUser=JSON.parse(r),this.isLoggedIn=!0)}saveUserToStorage(r){localStorage.setItem("currentUser",JSON.stringify(r))}clearUserFromStorage(){localStorage.removeItem("currentUser")}login(r,e){let o={user:{email:r,password:e}};return this.apiService.post("/users/sign_in",o).pipe(s(t=>{t.success&&t.data&&(this.currentUser=t.data,this.saveUserToStorage(t.data),this.isLoggedIn=!0)}))}signup(r,e,o,t,m,d){let h={user:{email:r,password:e,password_confirmation:o,first_name:t,last_name:m,type:d}};return this.apiService.post("/users",h).pipe(s(i=>{i.success&&i.data&&(this.currentUser=i.data,this.saveUserToStorage(i.data),this.isLoggedIn=!0)}))}logout(){return this.apiService.delete("/users/sign_out").pipe(s(()=>{this.currentUser=null,this.clearUserFromStorage(),this.isLoggedIn=!1}),c(()=>(this.currentUser=null,this.clearUserFromStorage(),this.isLoggedIn=!1,n(null))))}isAuthenticated(){return this.isLoggedIn}isAdmin(){return this.currentUser?.type==="Administrator"}isWaiter(){return this.currentUser?.type==="Waiter"}isCook(){return this.currentUser?.type==="Cook"}isKitchenStaff(){return this.isAdmin()||this.isWaiter()||this.isCook()}getCurrentUser(){return this.currentUser}static \u0275fac=function(e){return new(e||a)(g(l))};static \u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"})};export{p as a};
