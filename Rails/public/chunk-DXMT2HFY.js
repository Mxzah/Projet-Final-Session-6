import{a as s}from"./chunk-234KQWSJ.js";import{V as l,Z as o,h as n,j as i}from"./chunk-RLSS7KTN.js";var c=class r{constructor(e){this.apiService=e;this.loadTableFromStorage()}currentTable=null;currentTableSubject=new i(null);currentTable$=this.currentTableSubject.asObservable();loadTableFromStorage(){let e=sessionStorage.getItem("currentTable");e&&(this.currentTable=JSON.parse(e),this.currentTableSubject.next(this.currentTable))}saveTableToStorage(e){sessionStorage.setItem("currentTable",JSON.stringify(e))}validateQrToken(e){return this.apiService.get(`/api/tables/${e}`)}setCurrentTable(e){this.currentTable=e,this.saveTableToStorage(e),this.currentTableSubject.next(e)}getCurrentTable(){return this.currentTable}hasTable(){return this.currentTable!==null}clearTable(){this.currentTable=null,sessionStorage.removeItem("currentTable"),this.currentTableSubject.next(null)}setPendingToken(e){sessionStorage.setItem("pendingQrToken",e)}getPendingToken(){return sessionStorage.getItem("pendingQrToken")}clearPendingToken(){sessionStorage.removeItem("pendingQrToken")}validateAndSavePendingToken(){let e=this.getPendingToken();return e?new n(t=>{this.validateQrToken(e).subscribe({next:a=>{a.success&&a.data&&this.setCurrentTable(a.data),this.clearPendingToken(),t.next(!0),t.complete()},error:()=>{this.clearPendingToken(),t.next(!1),t.complete()}})}):new n(t=>{t.next(!1),t.complete()})}static \u0275fac=function(t){return new(t||r)(o(s))};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};export{c as a};
