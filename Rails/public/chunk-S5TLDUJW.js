import{a as Ce}from"./chunk-SJ24TNRC.js";import{a as ge}from"./chunk-U54RNCJV.js";import{a as ue}from"./chunk-Z2FRV3RQ.js";import{a as W,c as X,e as Z}from"./chunk-JZU62OJ3.js";import{a as ae,b as me}from"./chunk-I7AMMOYK.js";import{a as ce,b as de,c as se,e as le,f as pe,g as be}from"./chunk-ZBD6JLV6.js";import{C as H,D as J,G as K,H as Q,b as z,c as v,e as N,f as j,g as D,i as y,k as V,l as L,n as R,o as G,q as B,u as $,v as U,w as Y}from"./chunk-HXVBPVRM.js";import"./chunk-DCQBJ6LB.js";import{T as ee,U as te,W as ie,X as oe,Y as ne,Z as re,_ as fe}from"./chunk-33DWQQLF.js";import{a as q}from"./chunk-HALU6EK7.js";import{j as T}from"./chunk-TJODSPPL.js";import{Bb as h,Cb as I,Db as u,Eb as r,Fb as a,Gb as P,Lb as A,Pb as _,Rb as d,Ua as o,V as w,Z as E,bb as g,da as x,dc as m,ea as M,ec as c,fc as C,hb as k,qa as b,r as O,wb as F,xb as l,yb as p}from"./chunk-QXPTUTPQ.js";var S=class t{constructor(i){this.apiService=i}getComboItems(){return this.apiService.get("/api/combo_items").pipe(O(i=>i.data??[]))}createComboItem(i){return this.apiService.post("/api/combo_items",{combo_item:i}).pipe(O(e=>e.data))}static \u0275fac=function(e){return new(e||t)(E(q))};static \u0275prov=w({token:t,factory:t.\u0275fac,providedIn:"root"})};var _e=(t,i)=>i.id;function Ie(t,i){if(t&1&&(r(0,"div",6),m(1),a()),t&2){let e=d();o(),c(e.loadError())}}function ye(t,i){if(t&1&&(r(0,"div",6),m(1),a()),t&2){let e=d();o(),c(e.actionError())}}function Se(t,i){t&1&&(r(0,"div",7),P(1,"mat-spinner",11),a())}function Oe(t,i){if(t&1&&(r(0,"div",8),m(1),a()),t&2){let e=d();o(),c(e.ts.t("admin.comboItems.empty"))}}function Pe(t,i){if(t&1&&(r(0,"mat-card",12)(1,"mat-card-content",13)(2,"div",14)(3,"div",15),m(4),a(),r(5,"div",16),m(6),a()(),r(7,"div",17),m(8),a()()()),t&2){let e=i.$implicit;o(4),c(e.combo_name||"#"+e.combo_id),o(2),c(e.item_name||"#"+e.item_id),o(2),C("x",e.quantity)}}function we(t,i){if(t&1&&(r(0,"div",9),h(1,Pe,9,3,"mat-card",12,F().trackByComboItemId,!0),a()),t&2){let e=d();o(),I(e.comboItems())}}function Ee(t,i){if(t&1&&(r(0,"mat-option",24),m(1),a()),t&2){let e=i.$implicit;u("value",e.id),o(),c(e.name)}}function ke(t,i){if(t&1&&(r(0,"mat-error"),m(1),a()),t&2){let e=d(2);o(),c(e.ts.t("admin.comboItems.comboRequired"))}}function Fe(t,i){if(t&1&&(r(0,"mat-option",24),m(1),a()),t&2){let e=i.$implicit;u("value",e.id),o(),c(e.name)}}function Ae(t,i){if(t&1&&(r(0,"mat-error"),m(1),a()),t&2){let e=d(2);o(),c(e.ts.t("admin.comboItems.itemRequired"))}}function Te(t,i){if(t&1&&m(0),t&2){let e=d(3);C(" ",e.ts.t("admin.comboItems.quantityRequired")," ")}}function qe(t,i){if(t&1&&m(0),t&2){let e=d(3);C(" ",e.ts.t("admin.comboItems.quantityMin")," ")}}function ze(t,i){if(t&1&&(r(0,"mat-error"),l(1,Te,1,1)(2,qe,1,1),a()),t&2){let e=d(2);o(),p(e.createForm.controls.quantity.errors.required?1:e.createForm.controls.quantity.errors.min?2:-1)}}function Ne(t,i){if(t&1){let e=A();r(0,"div",10)(1,"mat-card",18)(2,"button",19),_("click",function(){x(e);let s=d();return M(s.cancelCreate())}),r(3,"mat-icon"),m(4,"close"),a()(),r(5,"mat-card-header")(6,"mat-card-title",20),m(7),a()(),r(8,"mat-card-content")(9,"form",21),_("ngSubmit",function(){x(e);let s=d();return M(s.saveCreate())}),r(10,"mat-form-field",22)(11,"mat-label"),m(12),a(),r(13,"mat-select",23),h(14,Ee,2,2,"mat-option",24,_e),a(),l(16,ke,2,1,"mat-error"),a(),r(17,"mat-form-field",22)(18,"mat-label"),m(19),a(),r(20,"mat-select",25),h(21,Fe,2,2,"mat-option",24,_e),a(),l(23,Ae,2,1,"mat-error"),a(),r(24,"mat-form-field",22)(25,"mat-label"),m(26),a(),P(27,"input",26),l(28,ze,3,1,"mat-error"),a(),r(29,"mat-card-actions",27)(30,"button",28),_("click",function(){x(e);let s=d();return M(s.cancelCreate())}),m(31),a(),r(32,"button",29),m(33),a()()()()()()}if(t&2){let e=d();o(7),c(e.ts.t("admin.comboItems.createTitle")),o(2),u("formGroup",e.createForm),o(3),c(e.ts.t("admin.comboLabel")),o(2),I(e.combos()),o(2),p(e.createForm.controls.combo_id.dirty&&(e.createForm.controls.combo_id.errors!=null&&e.createForm.controls.combo_id.errors.required)?16:-1),o(3),c(e.ts.t("admin.itemLabel")),o(2),I(e.items()),o(2),p(e.createForm.controls.item_id.dirty&&(e.createForm.controls.item_id.errors!=null&&e.createForm.controls.item_id.errors.required)?23:-1),o(3),c(e.ts.t("admin.quantity")),o(2),p(e.createForm.controls.quantity.dirty&&e.createForm.controls.quantity.errors?28:-1),o(3),c(e.ts.t("admin.cancel")),o(),u("disabled",e.createForm.invalid||e.isSaving()),o(),C(" ",e.isSaving()?e.ts.t("admin.comboItems.creating"):e.ts.t("tables.create")," ")}}var ve=class t{constructor(i,e,n,s,f){this.comboItemsService=i;this.combosService=e;this.itemsService=n;this.errorService=s;this.ts=f}comboItems=b([]);combos=b([]);items=b([]);isLoading=b(!0);loadError=b("");actionError=b("");isCreating=b(!1);isSaving=b(!1);createForm=new D({combo_id:new y(null,[v.required]),item_id:new y(null,[v.required]),quantity:new y(1,[v.required,v.min(1)])});ngOnInit(){this.loadData()}loadData(){this.isLoading.set(!0),this.loadError.set("");let i=3,e=()=>{i-=1,i===0&&this.isLoading.set(!1)};this.comboItemsService.getComboItems().subscribe({next:n=>{this.comboItems.set(n),e()},error:n=>{this.loadError.set(this.errorService.format(this.errorService.fromApiError(n))),e()}}),this.combosService.getCombos().subscribe({next:n=>{this.combos.set(n),e()},error:n=>{this.loadError.set(this.errorService.format(this.errorService.fromApiError(n))),e()}}),this.itemsService.getItems({admin:!0}).subscribe({next:n=>{this.items.set(n.filter(s=>!s.deleted_at)),e()},error:n=>{this.loadError.set(this.errorService.format(this.errorService.fromApiError(n))),e()}})}openCreate(){this.actionError.set(""),this.isCreating.set(!0),this.createForm.reset({combo_id:null,item_id:null,quantity:1}),this.createForm.markAsPristine(),this.createForm.markAsUntouched()}cancelCreate(){this.isCreating.set(!1),this.isSaving.set(!1),this.actionError.set("")}saveCreate(){if(Object.values(this.createForm.controls).forEach(f=>f.markAsDirty()),this.createForm.invalid||this.isSaving())return;let i=this.createForm.getRawValue(),e=Number(i.combo_id),n=Number(i.item_id),s=Number(i.quantity);this.actionError.set(""),this.isSaving.set(!0),this.comboItemsService.createComboItem({combo_id:e,item_id:n,quantity:s}).subscribe({next:f=>{this.comboItems.update(xe=>[f,...xe]),this.isSaving.set(!1),this.isCreating.set(!1)},error:f=>{this.actionError.set(this.errorService.format(this.errorService.fromApiError(f))),this.isSaving.set(!1)}})}trackByComboItemId(i,e){return e.id}static \u0275fac=function(e){return new(e||t)(g(S),g(Ce),g(ge),g(ue),g(fe))};static \u0275cmp=k({type:t,selectors:[["app-admin-combo-items"]],decls:16,vars:9,consts:[[1,"page-admin"],[1,"outer-container"],[1,"welcome-header"],[1,"welcome-title"],["mat-mini-fab","",1,"btn-add",3,"click","title"],[1,"welcome-text"],[1,"admin-error"],[1,"loading"],[1,"empty"],[1,"combo-items-list"],[1,"modal-overlay"],["diameter","48"],[1,"combo-item-card"],[1,"combo-item-body"],[1,"combo-item-main"],[1,"combo-item-combo"],[1,"combo-item-item"],[1,"combo-item-quantity"],[1,"modal","modal-create"],["mat-icon-button","",1,"modal-close",3,"click"],[1,"modal-title"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"modal-field-full"],["formControlName","combo_id"],[3,"value"],["formControlName","item_id"],["matInput","","type","number","min","1","step","1","formControlName","quantity"],[1,"modal-actions"],["mat-stroked-button","","type","button",1,"btn-cancel",3,"click"],["mat-flat-button","","type","submit",1,"btn-primary",3,"disabled"]],template:function(e,n){e&1&&(r(0,"main",0)(1,"div",1)(2,"div",2)(3,"h2",3),m(4),r(5,"button",4),_("click",function(){return n.openCreate()}),r(6,"mat-icon"),m(7,"add"),a()()(),r(8,"p",5),m(9),a()(),l(10,Ie,2,1,"div",6),l(11,ye,2,1,"div",6),l(12,Se,2,0,"div",7),l(13,Oe,2,1,"div",8),l(14,we,3,0,"div",9),a()(),l(15,Ne,34,11,"div",10)),e&2&&(o(4),C(" ",n.ts.t("admin.comboItems.title")," "),o(),u("title",n.ts.t("admin.comboItems.add")),o(4),c(n.ts.t("admin.comboItems.subtitle")),o(),p(n.loadError()?10:-1),o(),p(n.actionError()?11:-1),o(),p(n.isLoading()?12:-1),o(),p(!n.isLoading()&&n.comboItems().length===0?13:-1),o(),p(!n.isLoading()&&n.comboItems().length>0?14:-1),o(),p(n.isCreating()?15:-1))},dependencies:[T,$,V,z,L,N,j,B,G,R,be,ce,le,se,pe,de,oe,te,ie,ee,re,ne,J,H,U,Y,Q,K,Z,X,W,me,ae],styles:['@import"https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Space+Grotesk:wght@400;500;600&display=swap";[_nghost-%COMP%]{--ink: #1b1a17;--clay: #f3ede4;--sand: #fbf8f2;--copper: #c86d3f;--rust: #8a3f24;--sage: #7a8f6a;--shadow: 0 25px 60px rgba(27, 26, 23, .18);display:block;min-height:100vh;overflow-x:clip;overflow-y:visible;background:radial-gradient(circle at top left,#f7e6d8,#f9f5ef 45%,#efe7dc);color:var(--ink);font-family:Space Grotesk,Segoe UI,sans-serif}[_nghost-%COMP%]:before, [_nghost-%COMP%]:after{content:"";position:fixed;inset:auto auto 8% -10%;width:320px;height:320px;background:conic-gradient(from 120deg,#c86d3f26,#7a8f6a26);border-radius:50%;filter:blur(10px);z-index:0}[_nghost-%COMP%]:after{inset:-5% -10% auto auto;width:280px;height:280px;background:radial-gradient(circle,rgba(200,109,63,.2),transparent 70%)}.page[_ngcontent-%COMP%]{position:relative;z-index:1;display:grid;grid-template-columns:minmax(280px,560px);justify-content:center;align-items:start;padding:1rem clamp(1rem,3vw,3rem) 1.5rem}.site-header[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;justify-content:space-between;padding:1rem clamp(1rem,3vw,3rem);background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff}.brand[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;letter-spacing:.3rem;text-transform:uppercase;color:#fff}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem}.panel[_ngcontent-%COMP%]{background:var(--sand);border-radius:24px;padding:1.5rem 2rem;box-shadow:var(--shadow);border:1px solid rgba(27,26,23,.08);animation:_ngcontent-%COMP%_float-in .8s ease forwards}.panel__header[_ngcontent-%COMP%]{display:grid;gap:.25rem;margin-bottom:1rem}.eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.2rem;font-size:.75rem;color:var(--rust);margin:0}h1[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:clamp(2rem,3vw,2.6rem);margin:0}.subtitle[_ngcontent-%COMP%]{margin:0;color:#1b1a17b3}.form[_ngcontent-%COMP%]{display:grid;gap:.75rem}.field[_ngcontent-%COMP%]{display:grid;gap:.25rem}label[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border:1px solid rgba(27,26,23,.2);border-radius:12px;padding:.65rem .875rem;font-size:.95rem;background:#fff;transition:border-color .2s ease,box-shadow .2s ease}input[_ngcontent-%COMP%]:not([matInput]):focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--copper);box-shadow:0 0 0 3px #c86d3f33}.form__actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem;margin-top:.5rem}button[_ngcontent-%COMP%]{border-radius:999px;padding:.65rem 1.5rem;font-size:.9rem;font-weight:600;cursor:pointer;border:none}.primary[_ngcontent-%COMP%]{background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff;box-shadow:0 12px 25px #8a3f2459}.ghost[_ngcontent-%COMP%]{background:transparent;border:1px solid rgba(27,26,23,.2);color:var(--ink)}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]{border-color:#fff6;color:#fff}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]:hover{background:#ffffff26}@keyframes _ngcontent-%COMP%_float-in{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media(max-width:900px){.page[_ngcontent-%COMP%]{min-height:auto}}@media(max-width:600px){.panel[_ngcontent-%COMP%]{padding:2rem 1.5rem;border-radius:20px}.site-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.form__actions[_ngcontent-%COMP%]{flex-direction:column}button[_ngcontent-%COMP%]{width:100%}h1[_ngcontent-%COMP%]{font-size:1.75rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{padding:.75rem .875rem;font-size:.95rem}}@media(max-width:400px){[_nghost-%COMP%]{overflow-x:clip;overflow-y:visible}.page[_ngcontent-%COMP%]{padding:1.5rem 1rem 3rem;grid-template-columns:1fr}.panel[_ngcontent-%COMP%]{padding:1.5rem 1rem;border-radius:16px}.site-header[_ngcontent-%COMP%]{padding:1rem 1rem 0}h1[_ngcontent-%COMP%]{font-size:1.5rem}.subtitle[_ngcontent-%COMP%]{font-size:.9rem}label[_ngcontent-%COMP%]{font-size:.875rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border-radius:10px;padding:.7rem .75rem;font-size:.9rem}button[_ngcontent-%COMP%]{padding:.7rem 1.2rem;font-size:.9rem}}.page-admin[_ngcontent-%COMP%]{position:relative;z-index:1;display:flex;flex-direction:column;align-items:center;min-height:calc(100vh - 60px);padding:2rem 1rem}.outer-container[_ngcontent-%COMP%]{max-width:760px;width:100%}.welcome-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem;position:sticky;top:7.5rem;z-index:30;background:radial-gradient(circle at top left,#f7e6d8,#f9f5ef 45%,#efe7dc);padding:.75rem 0 .5rem}.welcome-title[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:1.5rem;margin:0 0 .5rem;color:var(--rust);display:flex;align-items:center;justify-content:center;gap:.75rem}.welcome-text[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#1b1a17b3}.btn-add[_ngcontent-%COMP%]{background:var(--copper)!important;color:#fff!important;width:36px!important;height:36px!important}.combo-items-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:.85rem}.combo-item-card[_ngcontent-%COMP%]{border:1px solid rgba(27,26,23,.1);border-radius:14px!important;background:var(--sand)!important}.combo-item-body[_ngcontent-%COMP%]{display:flex!important;justify-content:space-between;align-items:center;gap:1rem;padding:.9rem 1rem!important}.combo-item-main[_ngcontent-%COMP%]{min-width:0}.combo-item-combo[_ngcontent-%COMP%]{color:var(--ink);font-weight:600;font-size:.95rem;margin-bottom:.2rem}.combo-item-item[_ngcontent-%COMP%]{color:#1b1a17a6;font-size:.84rem}.combo-item-quantity[_ngcontent-%COMP%]{color:var(--rust);font-weight:700;font-size:1rem;white-space:nowrap}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:3rem}.empty[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#1b1a1780}.admin-error[_ngcontent-%COMP%]{border:1px solid rgba(220,53,69,.25);color:#a12f3b;background:#fff1f3;border-radius:12px;padding:.65rem .85rem;margin-bottom:.8rem;font-size:.88rem}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0006;display:flex;align-items:center;justify-content:center;z-index:100}.modal[_ngcontent-%COMP%]{position:relative;background:var(--sand)!important;border-radius:16px!important;width:min(520px,calc(100vw - 2rem));padding:.75rem .75rem .25rem}.modal-close[_ngcontent-%COMP%]{position:absolute;top:.25rem;right:.25rem;color:#1b1a178c!important}.modal-title[_ngcontent-%COMP%]{color:var(--rust)!important;font-family:Fraunces,Times New Roman,serif!important;font-size:1.1rem!important}.modal-field-full[_ngcontent-%COMP%]{width:100%}.modal-actions[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end;gap:.6rem;margin-top:.4rem!important;padding:0!important}.btn-primary[_ngcontent-%COMP%]{background:var(--copper)!important;color:var(--sand)!important}.btn-cancel[_ngcontent-%COMP%]{color:var(--ink)!important;border-color:#1b1a1740!important}']})};export{ve as AdminComboItemsComponent};
