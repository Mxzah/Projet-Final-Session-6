import{a as b}from"./chunk-AEZNZYFK.js";import{g as c}from"./chunk-SS6MEMTN.js";import{Da as l,V as o,Z as n,h as a,j as s}from"./chunk-RLSS7KTN.js";var u=class r{constructor(e,t){this.apiService=e;this.isBrowser=c(t),this.isBrowser&&this.loadTableFromStorage()}currentTable=null;currentTableSubject=new s(null);currentTable$=this.currentTableSubject.asObservable();isBrowser;loadTableFromStorage(){if(!this.isBrowser)return;let e=sessionStorage.getItem("currentTable");e&&(this.currentTable=JSON.parse(e),this.currentTableSubject.next(this.currentTable))}saveTableToStorage(e){this.isBrowser&&sessionStorage.setItem("currentTable",JSON.stringify(e))}validateQrToken(e){return this.apiService.get(`/api/tables/${e}`)}setCurrentTable(e){this.currentTable=e,this.saveTableToStorage(e),this.currentTableSubject.next(e)}getCurrentTable(){return this.currentTable}hasTable(){return this.currentTable!==null}clearTable(){this.currentTable=null,this.isBrowser&&sessionStorage.removeItem("currentTable"),this.currentTableSubject.next(null)}setPendingToken(e){this.isBrowser&&sessionStorage.setItem("pendingQrToken",e)}getPendingToken(){return this.isBrowser?sessionStorage.getItem("pendingQrToken"):null}clearPendingToken(){this.isBrowser&&sessionStorage.removeItem("pendingQrToken")}validateAndSavePendingToken(){let e=this.getPendingToken();return e?new a(t=>{this.validateQrToken(e).subscribe({next:i=>{i.success&&i.data&&this.setCurrentTable(i.data),this.clearPendingToken(),t.next(!0),t.complete()},error:()=>{this.clearPendingToken(),t.next(!1),t.complete()}})}):new a(t=>{t.next(!1),t.complete()})}static \u0275fac=function(t){return new(t||r)(n(b),n(l))};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};export{u as a};
