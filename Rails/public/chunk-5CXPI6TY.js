import{a as Z,c as ee,d as te,e as ne}from"./chunk-YPZEG5PR.js";import{a as me,b as le}from"./chunk-CZH2WNCU.js";import{g as de}from"./chunk-MT447YXZ.js";import{a as pe}from"./chunk-L6DW2PLB.js";import{C as K,D as Q,G as W,H as X,b as V,c as _,e as N,f as j,g as D,i as O,k as G,l as R,n as q,o as L,p as A,q as H,u as B,v as U,w as Y,x as $,z as J}from"./chunk-SV7ND62C.js";import{a as se}from"./chunk-WZOP5AFX.js";import{c as ce}from"./chunk-3RLE5XW6.js";import{ha as ie,ka as oe,la as re,ma as ae}from"./chunk-SYYZOLA4.js";import{a as z}from"./chunk-33E3YQOI.js";import{a as k}from"./chunk-HZIK2TNL.js";import{c as F}from"./chunk-ACJXZDTR.js";import{j as E}from"./chunk-GKGO7CCA.js";import{Bb as T,Cb as w,Db as u,Eb as a,Fb as r,Gb as f,Lb as I,Pb as h,Rb as l,Ua as i,ac as M,bb as p,da as P,dc as m,ea as S,ec as s,fc as b,gc as x,hb as y,qa as v,xb as d,yb as c}from"./chunk-QXPTUTPQ.js";var ge=(e,o)=>o.id;function ue(e,o){if(e&1&&(a(0,"div",2)(1,"mat-icon",4),m(2,"qr_code_scanner"),r(),a(3,"h2",5),m(4),r(),a(5,"p",6),m(6),r()()),e&2){let t=l();i(4),s(t.ts.t("form.noTable")),i(2),s(t.ts.t("form.noTableText"))}}function be(e,o){if(e&1&&(a(0,"mat-error"),m(1),r()),e&2){let t=l(3);i(),s(t.ts.t("form.guestsRequired"))}}function _e(e,o){if(e&1&&(a(0,"mat-error"),m(1),r()),e&2){let t=l(3);i(),s(t.ts.t("form.guestsMin"))}}function xe(e,o){if(e&1&&(a(0,"mat-error"),m(1),r()),e&2){let t=l(3);i(),x("",t.ts.t("form.guestsMax")," ",t.table.capacity,".")}}function Ce(e,o){if(e&1&&d(0,be,2,1,"mat-error")(1,_e,2,1,"mat-error")(2,xe,2,2,"mat-error"),e&2){let t=l(2);c(t.guestCtrl.hasError("required")?0:t.guestCtrl.hasError("min")?1:t.guestCtrl.hasError("max")?2:-1)}}function ve(e,o){if(e&1&&(f(0,"span",17),m(1)),e&2){let t=o;M("background",t.color),i(),b(" ",t.name," ")}}function he(e,o){if(e&1&&(a(0,"mat-option",13),f(1,"mat-spinner",18),m(2),r()),e&2){let t=l(2);i(2),b(" ",t.ts.t("form.loading")," ")}}function Me(e,o){if(e&1&&(a(0,"mat-option",19),f(1,"span",17),m(2),r()),e&2){let t=o.$implicit;u("value",t.id),i(),M("background",t.color),i(),b(" ",t.name," ")}}function Oe(e,o){if(e&1&&T(0,Me,3,4,"mat-option",19,ge),e&2){let t=l(2);w(t.vibes)}}function Pe(e,o){if(e&1&&(a(0,"mat-error"),m(1),r()),e&2){let t=l(2);i(),s(t.ts.t("form.vibeRequired"))}}function Se(e,o){if(e&1&&(a(0,"div",14)(1,"mat-icon"),m(2,"error_outline"),r(),a(3,"span"),m(4),r()()),e&2){let t=l(2);i(4),s(t.apiError())}}function ye(e,o){e&1&&(a(0,"mat-icon"),m(1,"restaurant_menu"),r())}function Te(e,o){e&1&&f(0,"mat-spinner",16)}function we(e,o){if(e&1){let t=I();a(0,"div",3)(1,"div",7)(2,"h2",5),m(3),r(),a(4,"p",6),m(5),r()(),a(6,"form",8),h("ngSubmit",function(){P(t);let g=l();return S(g.goToMenu())}),a(7,"mat-form-field",9)(8,"mat-label"),m(9),r(),f(10,"input",10),a(11,"mat-icon",11),m(12,"people"),r(),a(13,"mat-hint"),m(14),r(),d(15,Ce,3,1),r(),a(16,"mat-form-field",9)(17,"mat-label"),m(18),r(),a(19,"mat-select",12)(20,"mat-select-trigger"),d(21,ve,2,3),r(),d(22,he,3,1,"mat-option",13)(23,Oe,2,0),r(),d(24,Pe,2,1,"mat-error"),r(),d(25,Se,5,1,"div",14),a(26,"button",15),d(27,ye,2,0,"mat-icon"),d(28,Te,1,0,"mat-spinner",16),m(29),r()()()}if(e&2){let t,n=l();i(3),x("",n.ts.t("form.title")," #",n.table.number),i(2),s(n.ts.t("form.subtitle")),i(),u("formGroup",n.form),i(3),s(n.ts.t("form.guests")),i(),u("max",n.table.capacity),i(4),x("",n.ts.t("form.guestsHint")," ",n.table.capacity),i(),c(n.guestCtrl.touched?15:-1),i(3),s(n.ts.t("form.vibe")),i(3),c((t=n.getSelectedVibe())?21:-1,t),i(),c(n.vibesLoading?22:23),i(2),c(n.vibeCtrl.invalid&&n.vibeCtrl.touched?24:-1),i(),c(n.apiError()?25:-1),i(),u("disabled",n.form.invalid||n.vibesLoading||n.isSubmitting()),i(),c(n.isSubmitting()?-1:27),i(),c(n.isSubmitting()?28:-1),i(),b(" ",n.isSubmitting()?n.ts.t("form.submitting"):n.ts.t("form.submit")," ")}}var fe=class e{constructor(o,t,n,g,C){this.tableService=o;this.authService=t;this.orderService=n;this.ts=g;this.router=C}table=null;noTable=!1;vibes=[];vibesLoading=!0;isSubmitting=v(!1);apiError=v(null);form;ngOnInit(){if(this.table=this.tableService.getCurrentTable(),!this.table){this.noTable=!0;return}this.form=new D({guestCount:new O(null,[_.required,_.min(1),_.max(this.table.capacity)]),vibeId:new O(null,_.required)}),this.loadVibes()}loadVibes(){this.orderService.getVibes().subscribe({next:o=>{this.vibes=o.data||[],this.vibesLoading=!1},error:()=>{this.vibesLoading=!1}})}get guestCtrl(){return this.form.get("guestCount")}get vibeCtrl(){return this.form.get("vibeId")}getSelectedVibe(){return this.vibes.find(o=>o.id===this.vibeCtrl.value)??null}goToMenu(){if(this.form.invalid||this.isSubmitting())return;let{guestCount:o,vibeId:t}=this.form.value,n=this.table;this.isSubmitting.set(!0),this.apiError.set(null),this.orderService.createOrder({nb_people:o,note:"",table_id:n.id,vibe_id:t??null}).subscribe({next:()=>{this.router.navigate(["/menu"])},error:g=>{let C=g?.errors??[];this.apiError.set(C.length?C.join(" "):this.ts.t("form.createError")),this.isSubmitting.set(!1)}})}logout(){this.authService.logout().subscribe({next:()=>{this.tableService.clearTable(),this.router.navigate(["/login"])},error:()=>{this.tableService.clearTable(),this.router.navigate(["/login"])}})}static \u0275fac=function(t){return new(t||e)(p(se),p(z),p(pe),p(k),p(F))};static \u0275cmp=y({type:e,selectors:[["app-table-form"]],decls:4,vars:2,consts:[[3,"logoutClick"],[1,"form-page"],[1,"form-card","no-table-card"],[1,"form-card"],[1,"no-table-icon"],[1,"form-title"],[1,"form-subtitle"],[1,"form-header"],[1,"form-body",3,"ngSubmit","formGroup"],["appearance","outline",1,"field-full"],["matInput","","type","number","formControlName","guestCount","min","1","step","1",3,"max"],["matSuffix",""],["formControlName","vibeId"],["disabled",""],[1,"api-error"],["mat-raised-button","","color","primary","type","submit",1,"submit-btn",3,"disabled"],["diameter","20",1,"btn-spinner"],[1,"vibe-dot"],["diameter","18",1,"inline-spinner"],[3,"value"]],template:function(t,n){t&1&&(a(0,"app-header",0),h("logoutClick",function(){return n.logout()}),r(),a(1,"main",1),d(2,ue,7,2,"div",2),d(3,we,30,18,"div",3),r()),t&2&&(i(2),c(n.noTable?2:-1),i(),c(n.table?3:-1))},dependencies:[E,B,G,V,R,N,j,H,A,L,q,ce,Q,K,U,$,Y,J,X,W,ne,ee,te,Z,oe,ie,ae,re,de,le,me],styles:['@import"https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Space+Grotesk:wght@400;500;600&display=swap";[_nghost-%COMP%]{--ink: #1b1a17;--clay: #f3ede4;--sand: #fbf8f2;--copper: #c86d3f;--rust: #8a3f24;--sage: #7a8f6a;--shadow: 0 25px 60px rgba(27, 26, 23, .18);display:block;min-height:100vh;overflow-x:clip;overflow-y:visible;background:radial-gradient(circle at top left,#f7e6d8,#f9f5ef 45%,#efe7dc);color:var(--ink);font-family:Space Grotesk,Segoe UI,sans-serif}[_nghost-%COMP%]:before, [_nghost-%COMP%]:after{content:"";position:fixed;inset:auto auto 8% -10%;width:320px;height:320px;background:conic-gradient(from 120deg,#c86d3f26,#7a8f6a26);border-radius:50%;filter:blur(10px);z-index:0}[_nghost-%COMP%]:after{inset:-5% -10% auto auto;width:280px;height:280px;background:radial-gradient(circle,rgba(200,109,63,.2),transparent 70%)}.page[_ngcontent-%COMP%]{position:relative;z-index:1;display:grid;grid-template-columns:minmax(280px,560px);justify-content:center;align-items:start;padding:1rem clamp(1rem,3vw,3rem) 1.5rem}.site-header[_ngcontent-%COMP%]{position:relative;z-index:2;display:flex;align-items:center;justify-content:space-between;padding:1rem clamp(1rem,3vw,3rem);background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff}.brand[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;letter-spacing:.3rem;text-transform:uppercase;color:#fff}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem}.panel[_ngcontent-%COMP%]{background:var(--sand);border-radius:24px;padding:1.5rem 2rem;box-shadow:var(--shadow);border:1px solid rgba(27,26,23,.08);animation:_ngcontent-%COMP%_float-in .8s ease forwards}.panel__header[_ngcontent-%COMP%]{display:grid;gap:.25rem;margin-bottom:1rem}.eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.2rem;font-size:.75rem;color:var(--rust);margin:0}h1[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:clamp(2rem,3vw,2.6rem);margin:0}.subtitle[_ngcontent-%COMP%]{margin:0;color:#1b1a17b3}.form[_ngcontent-%COMP%]{display:grid;gap:.75rem}.field[_ngcontent-%COMP%]{display:grid;gap:.25rem}label[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border:1px solid rgba(27,26,23,.2);border-radius:12px;padding:.65rem .875rem;font-size:.95rem;background:#fff;transition:border-color .2s ease,box-shadow .2s ease}input[_ngcontent-%COMP%]:not([matInput]):focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--copper);box-shadow:0 0 0 3px #c86d3f33}.form__actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem;margin-top:.5rem}button[_ngcontent-%COMP%]{border-radius:999px;padding:.65rem 1.5rem;font-size:.9rem;font-weight:600;cursor:pointer;border:none}.primary[_ngcontent-%COMP%]{background:linear-gradient(120deg,var(--copper),var(--rust));color:#fff;box-shadow:0 12px 25px #8a3f2459}.ghost[_ngcontent-%COMP%]{background:transparent;border:1px solid rgba(27,26,23,.2);color:var(--ink)}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]{border-color:#fff6;color:#fff}.site-header[_ngcontent-%COMP%]   .ghost[_ngcontent-%COMP%]:hover{background:#ffffff26}@keyframes _ngcontent-%COMP%_float-in{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media(max-width:900px){.page[_ngcontent-%COMP%]{min-height:auto}}@media(max-width:600px){.panel[_ngcontent-%COMP%]{padding:2rem 1.5rem;border-radius:20px}.site-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.form__actions[_ngcontent-%COMP%]{flex-direction:column}button[_ngcontent-%COMP%]{width:100%}h1[_ngcontent-%COMP%]{font-size:1.75rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{padding:.75rem .875rem;font-size:.95rem}}@media(max-width:400px){[_nghost-%COMP%]{overflow-x:clip;overflow-y:visible}.page[_ngcontent-%COMP%]{padding:1.5rem 1rem 3rem;grid-template-columns:1fr}.panel[_ngcontent-%COMP%]{padding:1.5rem 1rem;border-radius:16px}.site-header[_ngcontent-%COMP%]{padding:1rem 1rem 0}h1[_ngcontent-%COMP%]{font-size:1.5rem}.subtitle[_ngcontent-%COMP%]{font-size:.9rem}label[_ngcontent-%COMP%]{font-size:.875rem}input[_ngcontent-%COMP%]:not([matInput]), select[_ngcontent-%COMP%]{border-radius:10px;padding:.7rem .75rem;font-size:.9rem}button[_ngcontent-%COMP%]{padding:.7rem 1.2rem;font-size:.9rem}}.form-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 60px);padding:1.5rem 1rem}.form-card[_ngcontent-%COMP%]{background:var(--sand);border:1px solid rgba(200,109,63,.2);border-radius:24px;padding:2.5rem;max-width:520px;width:100%;box-shadow:0 10px 40px #1b1a1714}.form-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.form-title[_ngcontent-%COMP%]{font-family:Fraunces,Times New Roman,serif;font-size:1.6rem;margin:0 0 .5rem;color:var(--rust)}.form-subtitle[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#1b1a17a6}.form-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.field-full[_ngcontent-%COMP%]{width:100%}.submit-btn[_ngcontent-%COMP%]{width:100%;margin-top:.75rem;height:48px;font-size:1rem!important;font-family:Space Grotesk,Segoe UI,sans-serif!important;border-radius:12px!important;background:linear-gradient(120deg,var(--copper),var(--rust))!important;color:#fff!important;display:flex;align-items:center;justify-content:center;gap:.5rem}.submit-btn[_ngcontent-%COMP%]:disabled{opacity:.55!important;cursor:not-allowed}.vibe-dot[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;border-radius:50%;margin-right:.5rem;flex-shrink:0;vertical-align:middle;border:1px solid rgba(27,26,23,.12)}.inline-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:.4rem}.no-table-card[_ngcontent-%COMP%]{text-align:center;padding:3rem 2.5rem;display:flex;flex-direction:column;align-items:center;gap:.75rem}.no-table-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;color:var(--copper);margin-bottom:.5rem}.api-error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:#8a3f2414;border:1px solid rgba(138,63,36,.25);color:var(--rust);border-radius:10px;padding:.65rem .9rem;font-size:.88rem}.api-error[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.1rem;width:1.1rem;height:1.1rem;flex-shrink:0}.btn-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-right:.5rem}  .form-body .mat-mdc-form-field.mat-focused .mdc-notched-outline__leading,   .form-body .mat-mdc-form-field.mat-focused .mdc-notched-outline__notch,   .form-body .mat-mdc-form-field.mat-focused .mdc-notched-outline__trailing{border-color:var(--copper)!important}  .form-body .mat-mdc-form-field.mat-focused .mat-mdc-floating-label{color:var(--copper)!important}  .form-body .mdc-text-field--focused .mdc-notched-outline__leading,   .form-body .mdc-text-field--focused .mdc-notched-outline__notch,   .form-body .mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--copper)!important}@media(max-width:560px){.form-page[_ngcontent-%COMP%]{padding:1.25rem .5rem .75rem;justify-content:flex-start}.form-card[_ngcontent-%COMP%]{padding:1.5rem 1.1rem;border-radius:16px}.form-title[_ngcontent-%COMP%]{font-size:1.3rem}.form-subtitle[_ngcontent-%COMP%]{font-size:.82rem}.form-header[_ngcontent-%COMP%]{margin-bottom:1.25rem}.submit-btn[_ngcontent-%COMP%]{height:44px;font-size:.92rem!important}}@media(max-width:380px){.form-page[_ngcontent-%COMP%]{padding:1rem .35rem .5rem}.form-card[_ngcontent-%COMP%]{padding:1.25rem .9rem;border-radius:14px}.form-title[_ngcontent-%COMP%]{font-size:1.15rem}}']})};export{fe as TableFormComponent};
